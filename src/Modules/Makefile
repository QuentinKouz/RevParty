CC = gcc
CFLAGS = -w -std=c99 -pedantic -Wall
EXEC_DIR = ../Executables

UTILS_SD_SOURCES = utils_sd.c
LISTE_SOURCES = element_liste.c liste.c
UNINOMINALES_SOURCES = uninominales.c
CONDORCET_MINIMAX_SOURCES = condorcet_minimax.c
CONDORCET_PAIRES_SOURCES = condorcet_paires.c
CONDORCET_SCHULZE_SOURCES = condorcet_schulze.c
JUGEMENT_MAJ_SOURCES = jugement_majoritaire.c
LECTURE_CSV_SOURCES = lecture_csv.c
MAIN_SOURCES = main.c
VERIFY_MY_VOTE_SOURCES = verify_my_vote.c

COMMON_SOURCES = $(UTILS_SD_SOURCES) $(LISTE_SOURCES) $(UNINOMINALES_SOURCES) $(CONDORCET_MINIMAX_SOURCES) $(CONDORCET_PAIRES_SOURCES) $(CONDORCET_SCHULZE_SOURCES) $(JUGEMENT_MAJ_SOURCES) $(LECTURE_CSV_SOURCES)
VOTE_SOURCES = sha256.c sha256_utils.c lecture_csv.c

COMMON_OBJECTS = $(COMMON_SOURCES:.c=.o)
MAIN_OBJECTS = $(MAIN_SOURCES:.c=.o)
VERIFY_MY_VOTE_OBJECTS = $(VERIFY_MY_VOTE_SOURCES:.c=.o)
VOTE_OBJECTS = $(VOTE_SOURCES:.c=.o)

.PHONY: all clean

all: main verify_my_vote

main: $(COMMON_OBJECTS) $(MAIN_OBJECTS)
	$(CC) $(COMMON_OBJECTS) $(MAIN_OBJECTS) -o $(EXEC_DIR)/$@

verify_my_vote: $(VERIFY_MY_VOTE_OBJECTS) $(VOTE_OBJECTS)
	$(CC) $(VERIFY_MY_VOTE_OBJECTS) $(VOTE_OBJECTS) -o $(EXEC_DIR)/$@

%.o: %.c
	$(CC) $(CFLAGS) -c $< -o $@

clean:
	rm -f $(EXEC_DIR)/main $(EXEC_DIR)/verify_my_vote $(COMMON_OBJECTS) $(MAIN_OBJECTS) $(VERIFY_MY_VOTE_OBJECTS)
